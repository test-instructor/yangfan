(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{480:function(s,a,t){"use strict";t.r(a);var e=t(2),r=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("在源码解析过程中，我们已经讲解了 Httprunner（hrp）的核心功能。如果您发现有部分内容不够清楚，或者希望更深入了解特定功能的源代码，欢迎随时联系作者。")]),s._v(" "),a("p",[s._v("对于 Go 语言，很多测试从业者可能对安装第三方库、编译和交叉编译不太熟悉，这可能增加了学习成本。在本文中，我们将详细介绍如何进行编译，而在后续文章中，我们将进一步探讨一些简单的修改，例如跳过逻辑、修改请求和响应的头部状态、使用模拟数据、添加断言等。如果您有二次开发的需求，也可以随时联系作者。")]),s._v(" "),a("h2",{attrs:{id:"修改版本号"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改版本号"}},[s._v("#")]),s._v(" 修改版本号")]),s._v(" "),a("p",[s._v('虽然不强制要求修改版本号，但为了更好地区分不同版本，建议您修改版本号，并可以在版本号前或后添加前缀，例如："yangfan.v4.4.0" 或 "v4.4.0.yangfan"。版本号的存放路径应为："/httprunner/hrp/internal/version/VERSION"，它应该是一个字符串格式的文本文件。')]),s._v(" "),a("h2",{attrs:{id:"更新依赖"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#更新依赖"}},[s._v("#")]),s._v(" 更新依赖")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 首先，将 fork 的项目克隆到本地")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("git")]),s._v(" clone git@github.com:taylor9158/httprunner.git\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"命令行更新"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命令行更新"}},[s._v("#")]),s._v(" 命令行更新")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" httprunner\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 此步骤可以跳过，一般情况下都会出现timeout的错误")]),s._v("\ngo mod tidy\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h4",{attrs:{id:"错误处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#错误处理"}},[s._v("#")]),s._v(" 错误处理")]),s._v(" "),a("p",[s._v("请注意，更新依赖库时可能会因网络问题而出现超时错误。您可以通过设置 Go 代码模块来解决此问题：")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("go "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("env")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-w")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("GOPROXY")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("https://goproxy.cn,direct\ngo mod tidy\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"使用ide-goland-进行更新"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用ide-goland-进行更新"}},[s._v("#")]),s._v(" 使用IDE(Goland)进行更新")]),s._v(" "),a("ol",[a("li",[s._v("打开httprunner目录")]),s._v(" "),a("li",[s._v("在终端中执行命令")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 此步骤可以跳过，一般情况下都会出现timeout的错误")]),s._v("\ngo mod tidy\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"错误处理-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#错误处理-2"}},[s._v("#")]),s._v(" 错误处理")]),s._v(" "),a("p",[s._v("PS: 当使用 IDE 更新依赖库时，也可能会因网络问题而出现超时错误。您可以通过设置代码模块来解决这个问题")]),s._v(" "),a("ol",[a("li",[s._v("打开「设置 - Go - go 模块」")]),s._v(" "),a("li",[s._v("在「go 模块」中启用「启用 Go 模块集成」，并在输入框中填入「GOPROXY=https://goproxy.cn,direct」\n"),a("img",{attrs:{src:"img/gosetting.png",alt:"gosetting"}})]),s._v(" "),a("li",[s._v("重新执行「go mod tidy」（这一步骤可选）")]),s._v(" "),a("li",[s._v("如果设置后执行仍然有问题，尝试重启 Goland，然后再次执行「go mod tidy」")])]),s._v(" "),a("h2",{attrs:{id:"编译"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编译"}},[s._v("#")]),s._v(" 编译")]),s._v(" "),a("p",[s._v("在完成依赖安装后，您可以直接执行脚本进行编译，脚本的路径是「scripts/build.sh」，可以通过执行 make 或 bash 来进行编译。")]),s._v(" "),a("p",[s._v("提示：如果在添加了标签后无法成功编译，目前还不清楚问题出在哪里。这是当前系统下的构建文件。如果您想构建适用于其他系统的可执行文件，就需要进行交叉编译。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Usage:")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# $ make build")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# $ make build tags=opencv")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# or")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# $ bash scripts/build.sh")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# $ bash scripts/build.sh opencv")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("这是构建当前系统下用的文件，如果你想构建其他系统的可执行文件，就要用到交叉编译")]),s._v(" "),a("h3",{attrs:{id:"交叉编译"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#交叉编译"}},[s._v("#")]),s._v(" 交叉编译")]),s._v(" "),a("ol",[a("li",[s._v("交叉编译使用以下变量：\n"),a("ul",[a("li",[s._v('GOOS：用于指定目标操作系统，例如 "windows"、"linux"、"darwin"（macOS）、"freebsd" 等。')]),s._v(" "),a("li",[s._v('GOARCH：用于指定目标架构，例如 "amd64"、"386"、"arm" 等。')]),s._v(" "),a("li",[s._v("CGO_ENABLED：在交叉编译时，建议将其设置为 0，以确保生成的二进制文件不依赖于系统的 C 库，从而确保生成的二进制文件可以在不同平台上正确运行。")])])]),s._v(" "),a("li",[s._v("以编译linux为例，执行构建命令"),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CGO_ENABLED")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("GOOS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("linux "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("GOARCH")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("amd64 "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v(" scripts/build.sh\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])]),s._v(" "),a("h2",{attrs:{id:"编译windows可执行文件出现错误"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编译windows可执行文件出现错误"}},[s._v("#")]),s._v(" 编译windows可执行文件出现错误")]),s._v(" "),a("ol",[a("li",[s._v("用命令***CGO_ENABLED=0 GOOS=windows GOARCH=amd64 bash scripts/build.sh***无法正常输出后缀为exe的文件")]),s._v(" "),a("li",[a("code",[s._v("build.sh")]),s._v(" 文件中使用编译的命令为***go build -ldflags '-s -w' -o \"output/hrp\" hrp/cmd/cli/main.go***")]),s._v(" "),a("li",[s._v("由于输出的统一目录为"),a("code",[s._v("output/hrp")]),s._v(",所以生成的文件无法执行，下面是正确的执行：")])]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("CGO_ENABLED")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("GOOS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("windows "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("GOARCH")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("amd64 go build "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-ldflags")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'-s -w'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-o")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"output/hrp.exe"')]),s._v(" hrp/cmd/cli/main.go\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])])}),[],!1,null,null,null);a.default=r.exports}}]);